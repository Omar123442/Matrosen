<%- include('layout/Homepage.ejs') %>
<link rel="stylesheet" href="/css/report.css">

<!-- Flash message handling -->
<% if (messages && messages.success) { %>
    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="successModalLabel">Success</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <%= messages.success %>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
<% } %>

<% if (messages && messages.error) { %>
    <!-- Error Modal -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="errorModalLabel">Error</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <%= messages.error %>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
<% } %>

<div class="content mt-5 report-container">
    <div class="text-center report-heading">
        <h2 class="text-primary">Report an Issue</h2>
        <p class="text">Tell us about the issue you're facing, and we'll look into it as soon as possible.</p>
    </div>
    <div class="row d-flex justify-content-center">
        <div class="col-md-8">
            <div class="mt-4 p-4 shadow rounded report-form">
                <form action="/report" method="POST">
                    <div class="form-group mb-3">
                        <label for="email" class="mb-2 font-weight-bold text-secondary">Your Email:</label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            class="form-control rounded p-3" 
                            placeholder="Enter your email" 
                            required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="subject" class="mb-2 font-weight-bold text-secondary">Subject:</label>
                        <input 
                            type="text" 
                            id="subject" 
                            name="subject" 
                            class="form-control rounded p-3" 
                            placeholder="Enter the subject" 
                            required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="reportText" class="mb-2 font-weight-bold text-secondary">Describe the issue:</label>
                        <textarea 
                            id="reportText" 
                            name="reportText" 
                            rows="6" 
                            class="form-control rounded p-3" 
                            placeholder="Write your report here..." 
                            style="resize: none;" 
                            required></textarea>
                    </div>
                    <div class="text-end mt-3">
                        <button type="submit" class="btn btn-primary px-4">Submit Report</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<% if (messages && messages.success) { %>
    <script>
        var successModal = new bootstrap.Modal(document.getElementById('successModal'));
        successModal.show();
    </script>
<% } %>

<% if (messages && messages.error) { %>
    <script>
        var errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
        errorModal.show();
    </script>
<% } %>
